<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Memq_intf (tjr_mem_queue.Tjr_mem_queue__.Memq_intf)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">tjr_mem_queue</a> &#x00BB; <a href="../index.html">Tjr_mem_queue__</a> &#x00BB; Memq_intf</nav><h1>Module <code>Tjr_mem_queue__.Memq_intf</code></h1></header><aside><p>Mem_queue interfaces; don't open</p></aside><dl><dt class="spec type" id="type-mutex_ops"><a href="#type-mutex_ops" class="anchor"></a><code><span class="keyword">type</span> <span>('mutex, 'cvar, 't) mutex_ops</span></code><code> = </code><code>{</code><table class="record"><tr id="type-mutex_ops.create_mutex" class="anchored"><td class="def field"><a href="#type-mutex_ops.create_mutex" class="anchor"></a><code>create_mutex : unit <span>&#45;&gt;</span> <span><span>(<span class="type-var">'mutex</span>, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-mutex_ops.create_cvar" class="anchored"><td class="def field"><a href="#type-mutex_ops.create_cvar" class="anchor"></a><code>create_cvar : unit <span>&#45;&gt;</span> <span><span>(<span class="type-var">'cvar</span>, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-mutex_ops.lock" class="anchored"><td class="def field"><a href="#type-mutex_ops.lock" class="anchor"></a><code>lock : <span class="type-var">'mutex</span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-mutex_ops.signal" class="anchored"><td class="def field"><a href="#type-mutex_ops.signal" class="anchor"></a><code>signal : <span class="type-var">'cvar</span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-mutex_ops.unlock" class="anchored"><td class="def field"><a href="#type-mutex_ops.unlock" class="anchor"></a><code>unlock : <span class="type-var">'mutex</span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-mutex_ops.wait" class="anchored"><td class="def field"><a href="#type-mutex_ops.wait" class="anchor"></a><code>wait : <span class="type-var">'mutex</span> <span>&#45;&gt;</span> <span class="type-var">'cvar</span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr></table><code>}</code></dt><dd><p>What we need from mutexes and condition vars</p></dd></dl><dl><dt class="spec type" id="type-memq"><a href="#type-memq" class="anchor"></a><code><span class="keyword">type</span> <span>('mutex, 'cvar, 'msg) memq</span></code><code> = </code><code>{</code><table class="record"><tr id="type-memq.q" class="anchored"><td class="def field"><a href="#type-memq.q" class="anchor"></a><code>q : <span><span class="type-var">'msg</span> Stdlib.Queue.t</span>;</code></td><td class="doc"><p>mutable!!!</p></td></tr><tr id="type-memq.mutex" class="anchored"><td class="def field"><a href="#type-memq.mutex" class="anchor"></a><code>mutex : <span class="type-var">'mutex</span>;</code></td></tr><tr id="type-memq.cvar" class="anchored"><td class="def field"><a href="#type-memq.cvar" class="anchor"></a><code>cvar : <span class="type-var">'cvar</span>;</code></td></tr></table><code>}</code></dt><dd><p>The queue of messages. NOTE the q field contains a MUTABLE queue</p></dd></dl><dl><dt class="spec type" id="type-memq_ops"><a href="#type-memq_ops" class="anchor"></a><code><span class="keyword">type</span> <span>('msg, 'q, 't) memq_ops</span></code><code> = </code><code>{</code><table class="record"><tr id="type-memq_ops.memq_enqueue" class="anchored"><td class="def field"><a href="#type-memq_ops.memq_enqueue" class="anchor"></a><code>memq_enqueue : <span>msg:<span class="type-var">'msg</span></span> <span>&#45;&gt;</span> <span>q:<span class="type-var">'q</span></span> <span>&#45;&gt;</span> <span><span>(unit, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-memq_ops.memq_dequeue" class="anchored"><td class="def field"><a href="#type-memq_ops.memq_dequeue" class="anchor"></a><code>memq_dequeue : <span class="type-var">'q</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'msg</span>, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td></tr><tr id="type-memq_ops.memq_create" class="anchored"><td class="def field"><a href="#type-memq_ops.memq_create" class="anchor"></a><code>memq_create : unit <span>&#45;&gt;</span> <span><span>(<span class="type-var">'q</span>, <span class="type-var">'t</span>)</span> Tjr_monad.m</span>;</code></td><td class="doc"><p>FIXME?</p></td></tr></table><code>}</code></dt><dd><p>FIXME for initialization purposes, we may also want a non-monadic &quot;create&quot; operation; at the moment it is in the monad because mutexes and references are part of the semantic state, as see in mutex ops</p></dd></dl><div class="spec class-type" id="class-type-memq_as_obj"><a href="#class-type-memq_as_obj" class="anchor"></a><code><span class="keyword">class</span> <span class="keyword">type</span> ['msg, 't] <a href="class-type-memq_as_obj/index.html">memq_as_obj</a> = <span class="keyword">object</span> ... <span class="keyword">end</span></code></div></div></body></html>